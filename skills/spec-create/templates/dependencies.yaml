# Dependencies: ${TASK_NAME}
# Machine + human readable DAG for parallel dispatch

# ------------------------------------------------------------------------------
# Phases organize tasks logically. Tasks within a phase share prerequisites.
# ------------------------------------------------------------------------------
phases:
  - id: setup
    name: Setup
    tasks:
      - id: T001
        file: path/to/file.py
        depends_on: []
      - id: T002
        file: path/to/other.py
        depends_on: [T001]

  - id: core
    name: Core Implementation
    tasks:
      - id: T003
        file: src/feature.py
        depends_on: [T002]
      - id: T004
        file: src/handler.py
        depends_on: [T002]

  - id: integration
    name: Integration
    tasks:
      - id: T005
        file: src/main.py
        depends_on: [T003, T004]

  - id: testing
    name: Testing
    tasks:
      - id: T006
        file: tests/test_feature.py
        depends_on: [T005]

# ------------------------------------------------------------------------------
# Computed parallel batches (derived from DAG)
# task-dispatch uses this to maximize parallelism
#
# Batching rules:
# - Tasks with no dependencies go in batch 1
# - Tasks go in the earliest batch where all dependencies are satisfied
# - Tasks modifying the same file cannot be in the same batch
# - Phase boundaries don't force batch breaks if dependencies allow parallelism
# ------------------------------------------------------------------------------
batches:
  - batch: 1
    tasks: [T001]
  - batch: 2
    tasks: [T002]
  - batch: 3
    tasks: [T003, T004]  # Parallel: different files, same dependency satisfied
  - batch: 4
    tasks: [T005]
  - batch: 5
    tasks: [T006]

# ------------------------------------------------------------------------------
# Special actions (optional)
# For tasks that aren't file creation/modification
# ------------------------------------------------------------------------------
actions: []
  # - id: A001
  #   type: delete
  #   file: deprecated/old_module.py
  #   depends_on: [T005]
  # - id: A002
  #   type: rename
  #   from: src/temp.py
  #   to: src/final.py
  #   depends_on: [T003]
  # - id: A003
  #   type: move
  #   from: src/utils.py
  #   to: lib/utils.py
  #   depends_on: []
